{
  "hash": "cff03f2c7c62180d2431b1f23456e421",
  "result": {
    "markdown": "---\ntitle: \"Regression and Statistical Inference\"\nauthor: \"Geethika Tiramdas\"\nsubtitle: \"Assignment solutions\"\ntoc: true\nnumber-sections: false\n---\n\n\n# Part 1\n\nRead the data and check the dimensions. How many rows and how many columns does the data have? You could use e.g. the dim() command.\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-1_073e399e7dad082c44fd4d90539bf5b3'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.1\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\n# 1\n\ncar_data <- readRDS(\"../../Causal_Data_Science_Data/car_prices.rds\")\ncar_data <- na.omit(car_data)\ncat(\"Dimensions of the data:\", dim(car_data), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Dimensions of the data: 181 22\n```\n:::\n:::\n\n\n# Part 2\n\nUse appropriate commands to get a more detailed look at the data. What data types do you see? How do numbers differ from strings regarding their data type?\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-2_6632fa8cd91f5f86fa59143df41e29d1'}\n\n```{.r .cell-code}\n# 2\n\nsummary(car_data) # may also use str(car_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>   aspiration         doornumber          carbody           drivewheel       \n#>  Length:181         Length:181         Length:181         Length:181        \n#>  Class :character   Class :character   Class :character   Class :character  \n#>  Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n#>                                                                             \n#>                                                                             \n#>                                                                             \n#>  enginelocation       wheelbase        carlength        carwidth    \n#>  Length:181         Min.   : 86.60   Min.   :141.1   Min.   :60.30  \n#>  Class :character   1st Qu.: 94.50   1st Qu.:166.3   1st Qu.:64.00  \n#>  Mode  :character   Median : 96.50   Median :173.0   Median :65.40  \n#>                     Mean   : 98.21   Mean   :173.3   Mean   :65.74  \n#>                     3rd Qu.:100.40   3rd Qu.:180.2   3rd Qu.:66.50  \n#>                     Max.   :120.90   Max.   :208.1   Max.   :72.30  \n#>    carheight       curbweight    enginetype        cylindernumber    \n#>  Min.   :47.80   Min.   :1488   Length:181         Length:181        \n#>  1st Qu.:52.00   1st Qu.:2122   Class :character   Class :character  \n#>  Median :53.70   Median :2410   Mode  :character   Mode  :character  \n#>  Mean   :53.58   Mean   :2521                                        \n#>  3rd Qu.:55.50   3rd Qu.:2910                                        \n#>  Max.   :59.80   Max.   :4066                                        \n#>    enginesize     fuelsystem          boreratio         stroke    \n#>  Min.   : 61.0   Length:181         Min.   :2.540   Min.   :2.07  \n#>  1st Qu.: 98.0   Class :character   1st Qu.:3.150   1st Qu.:3.08  \n#>  Median :120.0   Mode  :character   Median :3.310   Median :3.23  \n#>  Mean   :127.1                      Mean   :3.325   Mean   :3.23  \n#>  3rd Qu.:141.0                      3rd Qu.:3.590   3rd Qu.:3.40  \n#>  Max.   :326.0                      Max.   :3.940   Max.   :4.17  \n#>  compressionratio   horsepower       peakrpm        citympg     \n#>  Min.   : 7.000   Min.   : 48.0   Min.   :4200   Min.   :13.00  \n#>  1st Qu.: 8.500   1st Qu.: 70.0   1st Qu.:4800   1st Qu.:19.00  \n#>  Median : 9.000   Median : 95.0   Median :5200   Median :24.00  \n#>  Mean   : 8.848   Mean   :106.2   Mean   :5182   Mean   :24.85  \n#>  3rd Qu.: 9.400   3rd Qu.:116.0   3rd Qu.:5500   3rd Qu.:30.00  \n#>  Max.   :11.500   Max.   :288.0   Max.   :6600   Max.   :49.00  \n#>    highwaympg        price      \n#>  Min.   :16.00   Min.   : 5118  \n#>  1st Qu.:25.00   1st Qu.: 7609  \n#>  Median :30.00   Median : 9980  \n#>  Mean   :30.48   Mean   :12999  \n#>  3rd Qu.:34.00   3rd Qu.:16430  \n#>  Max.   :54.00   Max.   :45400\n```\n:::\n\n```{.r .cell-code}\nhead(car_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"aspiration\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"doornumber\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"carbody\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"drivewheel\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"enginelocation\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"wheelbase\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carlength\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carwidth\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carheight\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"curbweight\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"enginetype\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"cylindernumber\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"enginesize\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fuelsystem\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"boreratio\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"stroke\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"compressionratio\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"horsepower\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"peakrpm\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"citympg\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"highwaympg\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"std\",\"2\":\"two\",\"3\":\"convertible\",\"4\":\"rwd\",\"5\":\"front\",\"6\":\"88.6\",\"7\":\"168.8\",\"8\":\"64.1\",\"9\":\"48.8\",\"10\":\"2548\",\"11\":\"dohc\",\"12\":\"four\",\"13\":\"130\",\"14\":\"mpfi\",\"15\":\"3.47\",\"16\":\"2.68\",\"17\":\"9.0\",\"18\":\"111\",\"19\":\"5000\",\"20\":\"21\",\"21\":\"27\",\"22\":\"13495\"},{\"1\":\"std\",\"2\":\"two\",\"3\":\"convertible\",\"4\":\"rwd\",\"5\":\"front\",\"6\":\"88.6\",\"7\":\"168.8\",\"8\":\"64.1\",\"9\":\"48.8\",\"10\":\"2548\",\"11\":\"dohc\",\"12\":\"four\",\"13\":\"130\",\"14\":\"mpfi\",\"15\":\"3.47\",\"16\":\"2.68\",\"17\":\"9.0\",\"18\":\"111\",\"19\":\"5000\",\"20\":\"21\",\"21\":\"27\",\"22\":\"16500\"},{\"1\":\"std\",\"2\":\"two\",\"3\":\"hatchback\",\"4\":\"rwd\",\"5\":\"front\",\"6\":\"94.5\",\"7\":\"171.2\",\"8\":\"65.5\",\"9\":\"52.4\",\"10\":\"2823\",\"11\":\"ohcv\",\"12\":\"six\",\"13\":\"152\",\"14\":\"mpfi\",\"15\":\"2.68\",\"16\":\"3.47\",\"17\":\"9.0\",\"18\":\"154\",\"19\":\"5000\",\"20\":\"19\",\"21\":\"26\",\"22\":\"16500\"},{\"1\":\"std\",\"2\":\"four\",\"3\":\"sedan\",\"4\":\"fwd\",\"5\":\"front\",\"6\":\"99.8\",\"7\":\"176.6\",\"8\":\"66.2\",\"9\":\"54.3\",\"10\":\"2337\",\"11\":\"ohc\",\"12\":\"four\",\"13\":\"109\",\"14\":\"mpfi\",\"15\":\"3.19\",\"16\":\"3.40\",\"17\":\"10.0\",\"18\":\"102\",\"19\":\"5500\",\"20\":\"24\",\"21\":\"30\",\"22\":\"13950\"},{\"1\":\"std\",\"2\":\"four\",\"3\":\"sedan\",\"4\":\"4wd\",\"5\":\"front\",\"6\":\"99.4\",\"7\":\"176.6\",\"8\":\"66.4\",\"9\":\"54.3\",\"10\":\"2824\",\"11\":\"ohc\",\"12\":\"five\",\"13\":\"136\",\"14\":\"mpfi\",\"15\":\"3.19\",\"16\":\"3.40\",\"17\":\"8.0\",\"18\":\"115\",\"19\":\"5500\",\"20\":\"18\",\"21\":\"22\",\"22\":\"17450\"},{\"1\":\"std\",\"2\":\"two\",\"3\":\"sedan\",\"4\":\"fwd\",\"5\":\"front\",\"6\":\"99.8\",\"7\":\"177.3\",\"8\":\"66.3\",\"9\":\"53.1\",\"10\":\"2507\",\"11\":\"ohc\",\"12\":\"five\",\"13\":\"136\",\"14\":\"mpfi\",\"15\":\"3.19\",\"16\":\"3.40\",\"17\":\"8.5\",\"18\":\"110\",\"19\":\"5500\",\"20\":\"19\",\"21\":\"25\",\"22\":\"15250\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nHas 22 Variables with \n\naspiration, doornumber, carbody, drivewheel, enginelocation, enginetype, cylindernumber, fuelsystem with *character values*, \n\nand wheelbase, carlength, carwidth, carheight, curbweight, enginesize, boreratio, stroke, compressionratio, horsepower, peakrpm, citympg, highwaympg, price with *numeric values*.\n\n\n# Part 3\n\nRun a linear regression. You want to explain what factors are relevant for the pricing of a car.\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-3_64a9f1b476a71e2683e72631b2d03d45'}\n\n```{.r .cell-code}\n# 3\ncar_model <- lm(price ~ doornumber + carbody + enginetype + fuelsystem + stroke + horsepower + citympg, data = car_data)\nsummary(car_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ doornumber + carbody + enginetype + fuelsystem + \n#>     stroke + horsepower + citympg, data = car_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -8922.8 -1774.7   -15.5  1466.0 16355.9 \n#> \n#> Coefficients:\n#>                  Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)       4992.75    6211.58   0.804 0.422701    \n#> doornumbertwo     -539.74     902.44  -0.598 0.550614    \n#> carbodyhardtop   -3617.15    2267.11  -1.595 0.112551    \n#> carbodyhatchback -6461.38    1753.77  -3.684 0.000312 ***\n#> carbodysedan     -4771.37    1848.61  -2.581 0.010736 *  \n#> carbodywagon     -6128.24    2032.18  -3.016 0.002978 ** \n#> enginetypedohcv  -9993.95    4639.52  -2.154 0.032711 *  \n#> enginetypel       4884.77    2028.64   2.408 0.017168 *  \n#> enginetypeohc     3202.33    1323.44   2.420 0.016640 *  \n#> enginetypeohcf    1565.76    1759.84   0.890 0.374935    \n#> enginetypeohcv    2557.31    1602.92   1.595 0.112570    \n#> fuelsystem2bbl    -153.25    1314.25  -0.117 0.907316    \n#> fuelsystemmfi    -7560.37    4217.62  -1.793 0.074908 .  \n#> fuelsystemmpfi   -1676.81    1515.73  -1.106 0.270251    \n#> fuelsystemspdi   -6473.78    1931.46  -3.352 0.000999 ***\n#> fuelsystemspfi     452.35    4125.97   0.110 0.912835    \n#> stroke            -697.37    1245.17  -0.560 0.576210    \n#> horsepower         173.88      16.93  10.268  < 2e-16 ***\n#> citympg           -166.47      96.59  -1.723 0.086716 .  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 3879 on 162 degrees of freedom\n#> Multiple R-squared:  0.792,\tAdjusted R-squared:  0.7689 \n#> F-statistic: 34.27 on 18 and 162 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nWith some limited knowledge about cars, I think the factors mentioned above are relevant to a car price.\nI will use horsepower for further analysis.\n\n# Part 4\n\nChoose one regressor and\n\n1. explain what data type it is and what values it can take on\n\n2. what effect it has on the price and what changing the value would have as a result\n\n3. whether its effect is statistically significant.\n\nChoosing \"horsepower\"\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-4_01b5c4a090a68d6b979797aa869979b5'}\n\n```{.r .cell-code}\n# 4\n\n# data type it is and what values it can take on\nstr(car_data$horsepower)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>  num [1:181] 111 111 154 102 115 110 110 110 140 160 ...\n```\n:::\n\n```{.r .cell-code}\n# effect it has on the price and what changing the value would have as a result\nsummary(car_model)$coefficients['horsepower',]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>     Estimate   Std. Error      t value     Pr(>|t|) \n#> 1.311579e+02 1.480934e+01 8.856434e+00 1.669974e-15\n```\n:::\n\n```{.r .cell-code}\n# statistically significant\nsummary(car_model)$coefficients['horsepower','Pr(>|t|)']\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 1.669974e-15\n```\n:::\n:::\n\n\n# Part 5\n\nAdd a variable seat_heating to the data and assign a value TRUE for all observations. You can use e.g. df %>% mutate(new_variable = value). Assign it to a new object and run a regression. What coefficient do you get for the new variable seat_heating and how can you explain it?\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-5_304c7a45a60b1661261575a4f3af14a1'}\n\n```{.r .cell-code}\n# 5\n\n# Add variable 'seat_heating' and run a regression\ncar_prices_new <- car_data %>%\n  mutate(seat_heating = TRUE) %>%\n  na.omit()\n\n# Run a regression with the new variable\nmodel_new <- lm(price ~ doornumber + carbody + enginetype + fuelsystem + stroke + horsepower + citympg + seat_heating, data = car_prices_new)\n\nsummary(car_prices_new$seat_heating)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>    Mode    TRUE \n#> logical     181\n```\n:::\n\n```{.r .cell-code}\nsummary(model_new)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ doornumber + carbody + enginetype + fuelsystem + \n#>     stroke + horsepower + citympg + seat_heating, data = car_prices_new)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -8922.8 -1774.7   -15.5  1466.0 16355.9 \n#> \n#> Coefficients: (1 not defined because of singularities)\n#>                  Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)       4992.75    6211.58   0.804 0.422701    \n#> doornumbertwo     -539.74     902.44  -0.598 0.550614    \n#> carbodyhardtop   -3617.15    2267.11  -1.595 0.112551    \n#> carbodyhatchback -6461.38    1753.77  -3.684 0.000312 ***\n#> carbodysedan     -4771.37    1848.61  -2.581 0.010736 *  \n#> carbodywagon     -6128.24    2032.18  -3.016 0.002978 ** \n#> enginetypedohcv  -9993.95    4639.52  -2.154 0.032711 *  \n#> enginetypel       4884.77    2028.64   2.408 0.017168 *  \n#> enginetypeohc     3202.33    1323.44   2.420 0.016640 *  \n#> enginetypeohcf    1565.76    1759.84   0.890 0.374935    \n#> enginetypeohcv    2557.31    1602.92   1.595 0.112570    \n#> fuelsystem2bbl    -153.25    1314.25  -0.117 0.907316    \n#> fuelsystemmfi    -7560.37    4217.62  -1.793 0.074908 .  \n#> fuelsystemmpfi   -1676.81    1515.73  -1.106 0.270251    \n#> fuelsystemspdi   -6473.78    1931.46  -3.352 0.000999 ***\n#> fuelsystemspfi     452.35    4125.97   0.110 0.912835    \n#> stroke            -697.37    1245.17  -0.560 0.576210    \n#> horsepower         173.88      16.93  10.268  < 2e-16 ***\n#> citympg           -166.47      96.59  -1.723 0.086716 .  \n#> seat_heatingTRUE       NA         NA      NA       NA    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 3879 on 162 degrees of freedom\n#> Multiple R-squared:  0.792,\tAdjusted R-squared:  0.7689 \n#> F-statistic: 34.27 on 18 and 162 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\nAs seen in summary of regression model \"seat_heatingTRUE\" with NA is what we get - indicates that this categorical variable (seat_heating) has only one level, that is value \"TRUE\". This is proved with summary statement above this. \n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}