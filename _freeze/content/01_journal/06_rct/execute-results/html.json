{
  "hash": "4c18a1ae4d6f235d15ea365b0646ec5d",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\nauthor: \"Geethika Tiramdas\"\nsubtitle: \"Assignment solutions\"\ntoc: true\nnumber-sections: false\n---\n\n\n## Part 1\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_ad4dc4c11fc207655b4a68c963157db8'}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(readr)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nabtest_data <- readRDS(\"../../Causal_Data_Science_Data/abtest_online.rds\")\n\n# Part 1\nsummary(abtest_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>       ip             chatbot        previous_visit   mobile_device  \n#>  Length:1000        Mode :logical   Min.   : 0.000   Mode :logical  \n#>  Class :character   FALSE:496       1st Qu.: 1.000   FALSE:683      \n#>  Mode  :character   TRUE :504       Median : 1.000   TRUE :317      \n#>                                     Mean   : 2.021                  \n#>                                     3rd Qu.: 3.000                  \n#>                                     Max.   :13.000                  \n#>     purchase     purchase_amount\n#>  Min.   :0.000   Min.   : 0.00  \n#>  1st Qu.:0.000   1st Qu.: 0.00  \n#>  Median :0.000   Median : 0.00  \n#>  Mean   :0.381   Mean   :13.14  \n#>  3rd Qu.:1.000   3rd Qu.:27.44  \n#>  Max.   :1.000   Max.   :81.35\n```\n:::\n\n```{.r .cell-code}\nggplot(abtest_data, aes(x = chatbot, y = previous_visit, fill = chatbot)) +\n  geom_boxplot() +\n  labs(title = \"Continuous covariate - previous_visit\",\n       x = \"Chatbot\", y = \"Previous Visits\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(abtest_data, aes(x = mobile_device, fill = chatbot)) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Categorical covariate - mobile_device\",\n       x = \"Mobile Device\", y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(abtest_data, aes(x = as.factor(purchase), fill = chatbot)) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Binary outcome - purchase\",\n       x = \"Purchase\", y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n\n\n## Part 2\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_e1d1d031e1e17e398efb7d6959d16705'}\n\n```{.r .cell-code}\nmodel_sales <- lm(purchase_amount ~ chatbot + mobile_device + previous_visit, data = abtest_data)\nsummary(model_sales)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot + mobile_device + previous_visit, \n#>     data = abtest_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -25.414 -14.428  -8.435  12.559  64.584 \n#> \n#> Coefficients:\n#>                   Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)        15.2840     1.1227  13.614  < 2e-16 ***\n#> chatbotTRUE        -6.8488     1.1792  -5.808 8.49e-09 ***\n#> mobile_deviceTRUE  -0.8562     1.2642  -0.677  0.49841    \n#> previous_visit      0.7792     0.2869   2.716  0.00673 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.6 on 996 degrees of freedom\n#> Multiple R-squared:  0.04243,\tAdjusted R-squared:  0.03954 \n#> F-statistic: 14.71 on 3 and 996 DF,  p-value: 2.228e-09\n```\n:::\n:::\n\n\n## Part 3\n\nInclude an interaction term for the subgroup (e.g., mobile users); chat bot interaction when using mobile device\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_66f3e0a2fb78e388dddb6a5d5d03273e'}\n\n```{.r .cell-code}\nmodel_interaction <- lm(purchase_amount ~ chatbot * mobile_device + previous_visit, data = abtest_data)\nsummary(model_interaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device + previous_visit, \n#>     data = abtest_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -25.403 -14.450  -8.445  12.549  64.562 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                   15.27384    1.19130  12.821  < 2e-16 ***\n#> chatbotTRUE                   -6.82837    1.42580  -4.789 1.93e-06 ***\n#> mobile_deviceTRUE             -0.82375    1.79309  -0.459  0.64605    \n#> previous_visit                 0.77914    0.28711   2.714  0.00677 ** \n#> chatbotTRUE:mobile_deviceTRUE -0.06455    2.52907  -0.026  0.97964    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.6 on 995 degrees of freedom\n#> Multiple R-squared:  0.04243,\tAdjusted R-squared:  0.03858 \n#> F-statistic: 11.02 on 4 and 995 DF,  p-value: 9.485e-09\n```\n:::\n\n```{.r .cell-code}\n# Compute the Conditional Average Treatment Effect (CATE) for mobile users\ncate_mobile <- coef(model_interaction)[\"chatbotTRUE:mobile_deviceTRUE\"]\ncat(\"CATE for Mobile Users:\", cate_mobile, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> CATE for Mobile Users: -0.06455412\n```\n:::\n:::\n\n\nThe CATE represents the additional effect of the `chatbot` for `mobile users compared to non-mobile users`. \n\nThat is, if the coefficient is statistically significant and positive, it suggests that the effect of the chat bot *on sales* is different for mobile users compared to non-mobile users.\n\n**Here the effect of the chat bot on sales is not different for mobile users compared to non-mobile users.**\n\n## Part 4\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_c08bead8a890cb9d050089481db1d42a'}\n\n```{.r .cell-code}\nmodel_logistic <- glm(purchase ~ chatbot + mobile_device + previous_visit, data = abtest_data, family = \"binomial\")\nsummary(model_logistic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot + mobile_device + previous_visit, \n#>     family = \"binomial\", data = abtest_data)\n#> \n#> Coefficients:\n#>                   Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)       -0.22185    0.12347  -1.797  0.07237 .  \n#> chatbotTRUE       -0.96894    0.13564  -7.144 9.09e-13 ***\n#> mobile_deviceTRUE -0.07119    0.14530  -0.490  0.62417    \n#> previous_visit     0.10606    0.03262   3.252  0.00115 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1262.2  on 996  degrees of freedom\n#> AIC: 1270.2\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\n# coefficient for chatbot\ncoef_chatbot <- coef(model_logistic)[\"chatbotTRUE\"]\n\n# Exponentiate the coefficient to get the odds ratio\nodds_ratio <- exp(coef_chatbot)\n\ncat(\"Odds Ratio for Chatbot:\", odds_ratio, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Odds Ratio for Chatbot: 0.3794843\n```\n:::\n:::\n\n\nIf odds_ratio is greater than 1, you can say that the introduction of the chatbot is associated with an increase in the odds of making a purchase, and vice versa.\n\n**Here it has no effect on increasing the odds of making the purchase.**\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}