{
  "hash": "d2c31cd982219f35b6881c97c80c238f",
  "result": {
    "markdown": "---\ntitle: \"Difference-in-Differences\"\nauthor: \"Geethika Tiramdas\"\nsubtitle: \"Assignment solutions\"\ntoc: true\nnumber-sections: false\n---\n\n\n## Part 1\n\nAssuming `frequency` of visits to the hospital is an even number after treatment and is odd before the treatment.\n\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-1_76bfac0286360dc933d8b11642670511'}\n\n```{.r .cell-code}\n# Part 1\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nhosp_data <- readRDS(\"../../Causal_Data_Science_Data/hospdd.rds\")\nhead(hosp_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"hospital\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"frequency\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"month\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"procedure\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"satis\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"3\",\"3\":\"7\",\"4\":\"1\",\"5\":\"4.106527\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"3\",\"4\":\"0\",\"5\":\"3.319475\"},{\"1\":\"1\",\"2\":\"4\",\"3\":\"2\",\"4\":\"0\",\"5\":\"3.411720\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"4\",\"4\":\"1\",\"5\":\"3.004025\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"3\",\"4\":\"0\",\"5\":\"3.110720\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"7\",\"4\":\"1\",\"5\":\"2.882164\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsummary(hosp_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>     hospital       frequency         month         procedure     \n#>  Min.   : 1.00   Min.   :1.000   Min.   :1.000   Min.   :0.0000  \n#>  1st Qu.:11.00   1st Qu.:1.000   1st Qu.:1.750   1st Qu.:0.0000  \n#>  Median :23.00   Median :2.000   Median :3.500   Median :0.0000  \n#>  Mean   :22.84   Mean   :2.473   Mean   :3.625   Mean   :0.2079  \n#>  3rd Qu.:35.00   3rd Qu.:4.000   3rd Qu.:5.250   3rd Qu.:0.0000  \n#>  Max.   :46.00   Max.   :4.000   Max.   :7.000   Max.   :1.0000  \n#>      satis       \n#>  Min.   :0.5468  \n#>  1st Qu.:2.8888  \n#>  Median :3.4975  \n#>  Mean   :3.6191  \n#>  3rd Qu.:4.2405  \n#>  Max.   :9.7129\n```\n:::\n\n```{.r .cell-code}\nmean_satis_treated_before <- hosp_data %>%\n  filter(procedure == 0, frequency %% 2 != 0) %>%\n  pull(satis) %>%\n  mean()\n\nmean_satis_treated_after <- hosp_data %>%\n  filter(procedure == 0, frequency %% 2 == 0)  %>%\n  pull(satis) %>%\n  mean()\n\nmean_satis_control_before <- hosp_data %>%\n  filter(procedure == 1, frequency %% 2 != 0) %>%\n  pull(satis) %>%\n  mean()\n\nmean_satis_control_after <- hosp_data %>%\n  filter(procedure == 1, frequency %% 2 == 0)  %>%\n  pull(satis) %>%\n  mean()\n\ncat(\"Mean Satisfaction for Treated Hospitals Before Treatment:\", mean_satis_treated_before, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Mean Satisfaction for Treated Hospitals Before Treatment: 3.468616\n```\n:::\n\n```{.r .cell-code}\ncat(\"Mean Satisfaction for Treated Hospitals After Treatment:\", mean_satis_treated_after, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Mean Satisfaction for Treated Hospitals After Treatment: 3.380761\n```\n:::\n\n```{.r .cell-code}\ncat(\"Mean Satisfaction for Control Hospitals Before Treatment:\", mean_satis_control_before, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Mean Satisfaction for Control Hospitals Before Treatment: 4.39925\n```\n:::\n\n```{.r .cell-code}\ncat(\"Mean Satisfaction for Control Hospitals After Treatment:\", mean_satis_control_after, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Mean Satisfaction for Control Hospitals After Treatment: 4.331852\n```\n:::\n:::\n\n\n## Part 2\n\n**include group and time fixed effects in the regression, i.e. one regressor for each month and one regressor for each hospital** as mentioned in the assignment.\n\nTo achieve a regressor for each month and a regressor for each hospital, we should use `as.factor(month) + as.factor(hospital)`.\n \nThe `month + hospital` approach treats them as continuous variables, assuming a linear relationship, while the `as.factor(month) + as.factor(hospital)` approach treats them as categorical factors, allowing for separate intercepts for each level. This approach allows for more flexibility in capturing potential non-linear relationships and different intercepts for each level.\n\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-2_485b48e5144b18a1c65306bf71a0b14c'}\n\n```{.r .cell-code}\nmodel_1 <- lm(satis ~ frequency + month + hospital, data = hosp_data)\nsummary(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ frequency + month + hospital, data = hosp_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.3038 -0.6704 -0.0750  0.5787  5.7590 \n#> \n#> Coefficients:\n#>               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  3.6273420  0.0396118  91.572  < 2e-16 ***\n#> frequency    0.0538983  0.0101629   5.303 1.17e-07 ***\n#> month        0.0720728  0.0055854  12.904  < 2e-16 ***\n#> hospital    -0.0176390  0.0008716 -20.238  < 2e-16 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 1.015 on 7364 degrees of freedom\n#> Multiple R-squared:  0.07561,\tAdjusted R-squared:  0.07523 \n#> F-statistic: 200.8 on 3 and 7364 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nmodel_2 <- lm(satis ~ frequency + as.factor(month) + as.factor(hospital), data = hosp_data)\nsummary(model_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ frequency + as.factor(month) + as.factor(hospital), \n#>     data = hosp_data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.5176 -0.4868 -0.0163  0.4764  4.5046 \n#> \n#> Coefficients:\n#>                        Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)            3.302483   0.059857  55.173  < 2e-16 ***\n#> frequency              0.053751   0.007786   6.903 5.51e-12 ***\n#> as.factor(month)2     -0.009608   0.030315  -0.317  0.75131    \n#> as.factor(month)3      0.021969   0.030315   0.725  0.46867    \n#> as.factor(month)4      0.349354   0.030315  11.524  < 2e-16 ***\n#> as.factor(month)5      0.343235   0.030315  11.322  < 2e-16 ***\n#> as.factor(month)6      0.348800   0.030315  11.506  < 2e-16 ***\n#> as.factor(month)7      0.341444   0.030315  11.263  < 2e-16 ***\n#> as.factor(hospital)2   0.369283   0.080360   4.595 4.39e-06 ***\n#> as.factor(hospital)3   0.531657   0.082334   6.457 1.13e-10 ***\n#> as.factor(hospital)4   0.239008   0.076751   3.114  0.00185 ** \n#> as.factor(hospital)5  -0.187606   0.076976  -2.437  0.01483 *  \n#> as.factor(hospital)6   0.422811   0.076819   5.504 3.84e-08 ***\n#> as.factor(hospital)7   1.395230   0.074166  18.812  < 2e-16 ***\n#> as.factor(hospital)8   0.073894   0.079201   0.933  0.35085    \n#> as.factor(hospital)9  -1.541417   0.081267 -18.967  < 2e-16 ***\n#> as.factor(hospital)10  1.666597   0.080193  20.782  < 2e-16 ***\n#> as.factor(hospital)11  0.205881   0.079230   2.599  0.00938 ** \n#> as.factor(hospital)12 -0.088643   0.081205  -1.092  0.27504    \n#> as.factor(hospital)13  0.474560   0.078374   6.055 1.47e-09 ***\n#> as.factor(hospital)14  0.216930   0.082367   2.634  0.00846 ** \n#> as.factor(hospital)15 -0.180409   0.082498  -2.187  0.02879 *  \n#> as.factor(hospital)16  1.413378   0.080158  17.632  < 2e-16 ***\n#> as.factor(hospital)17  0.394071   0.083686   4.709 2.54e-06 ***\n#> as.factor(hospital)18  0.152851   0.097358   1.570  0.11646    \n#> as.factor(hospital)19 -1.171264   0.082334 -14.226  < 2e-16 ***\n#> as.factor(hospital)20 -0.372378   0.080160  -4.645 3.45e-06 ***\n#> as.factor(hospital)21  0.760720   0.084956   8.954  < 2e-16 ***\n#> as.factor(hospital)22  0.327933   0.083858   3.911 9.29e-05 ***\n#> as.factor(hospital)23  0.247468   0.082450   3.001  0.00270 ** \n#> as.factor(hospital)24 -0.765773   0.088275  -8.675  < 2e-16 ***\n#> as.factor(hospital)25  0.182556   0.094751   1.927  0.05406 .  \n#> as.factor(hospital)26 -0.231114   0.080218  -2.881  0.00397 ** \n#> as.factor(hospital)27 -0.831217   0.077505 -10.725  < 2e-16 ***\n#> as.factor(hospital)28  0.249922   0.085124   2.936  0.00334 ** \n#> as.factor(hospital)29 -0.230596   0.081591  -2.826  0.00472 ** \n#> as.factor(hospital)30 -0.597227   0.097361  -6.134 9.01e-10 ***\n#> as.factor(hospital)31  0.064165   0.080233   0.800  0.42389    \n#> as.factor(hospital)32 -0.767554   0.081252  -9.447  < 2e-16 ***\n#> as.factor(hospital)33 -0.904455   0.080250 -11.270  < 2e-16 ***\n#> as.factor(hospital)34 -0.419040   0.075363  -5.560 2.79e-08 ***\n#> as.factor(hospital)35 -0.069493   0.077495  -0.897  0.36988    \n#> as.factor(hospital)36  1.700127   0.078341  21.702  < 2e-16 ***\n#> as.factor(hospital)37 -0.301118   0.094608  -3.183  0.00146 ** \n#> as.factor(hospital)38 -0.501452   0.079212  -6.331 2.59e-10 ***\n#> as.factor(hospital)39 -0.465018   0.083615  -5.561 2.77e-08 ***\n#> as.factor(hospital)40  0.682455   0.079230   8.614  < 2e-16 ***\n#> as.factor(hospital)41 -0.595735   0.077561  -7.681 1.79e-14 ***\n#> as.factor(hospital)42  0.432897   0.086529   5.003 5.78e-07 ***\n#> as.factor(hospital)43 -1.206881   0.082348 -14.656  < 2e-16 ***\n#> as.factor(hospital)44 -0.438119   0.092421  -4.740 2.17e-06 ***\n#> as.factor(hospital)45 -0.641833   0.077497  -8.282  < 2e-16 ***\n#> as.factor(hospital)46 -0.357058   0.083594  -4.271 1.97e-05 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.7512 on 7315 degrees of freedom\n#> Multiple R-squared:  0.4973,\tAdjusted R-squared:  0.4938 \n#> F-statistic: 139.2 on 52 and 7315 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThe difference is clearly seen by above code.\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}